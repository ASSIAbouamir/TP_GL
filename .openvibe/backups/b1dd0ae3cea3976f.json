{
  "id": "b1dd0ae3cea3976f",
  "filePath": "c:\\Users\\Hp\\Desktop\\TP_GL\\aarchitecture.md",
  "timestamp": 1764458982456,
  "originalContent": "# ğŸ“š Guide Complet des Fichiers et leurs Interactions\r\n\r\n## ğŸ¯ Vue d'Ensemble\r\n\r\nCe document explique **chaque fichier** du projet, son rÃ´le, et **comment il interagit** avec les autres fichiers dans l'architecture globale.\r\n\r\n---\r\n\r\n## ğŸ“ Structure par CatÃ©gories\r\n\r\n### **1. PRÃ‰PARATION DES DONNÃ‰ES**\r\n\r\n#### `prepare_data.py` â­ CORE\r\n**RÃ´le :** Script principal de prÃ©paration du dataset IAM\r\n\r\n**Fonctions principales :**\r\n- `check_dataset_exists()` : VÃ©rifie la prÃ©sence du dataset IAM\r\n- `get_stroke_sequence(filename)` : Extrait et normalise les strokes depuis XML\r\n- `get_ascii_sequences(filename)` : Extrait les transcriptions ASCII\r\n- `collect_data()` : Collecte tous les fichiers et crÃ©e les correspondances\r\n\r\n**Interactions :**\r\n```\r\nprepare_data.py\r\n    â”‚\r\n    â”œâ”€â†’ import drawing\r\n    â”‚   â””â”€ Utilise drawing.align(), drawing.denoise(), \r\n    â”‚      drawing.coords_to_offsets(), drawing.normalize()\r\n    â”‚      drawing.encode_ascii(), drawing.MAX_STROKE_LEN, \r\n    â”‚      drawing.MAX_CHAR_LEN, drawing.alphabet\r\n    â”‚\r\n    â”œâ”€â†’ Lit: data/raw/ascii/*.txt\r\n    â”œâ”€â†’ Lit: data/raw/lineStrokes/*.xml\r\n    â”œâ”€â†’ Lit: data/raw/original-xml/*.xml\r\n    â”‚\r\n    â””â”€â†’ Ã‰crit: data/processed/\r\n        â”œâ”€ x.npy      (strokes normalisÃ©s)\r\n        â”œâ”€ x_len.npy  (longueurs)\r\n        â”œâ”€ c.npy      (transcriptions)\r\n        â”œâ”€ c_len.npy  (longueurs textes)\r\n        â””â”€ w_id.npy   (IDs Ã©crivains)\r\n```\r\n\r\n**UtilisÃ© par :**\r\n- `rnn.py` (DataReader charge ces fichiers)\r\n- `check_data.py` (vÃ©rifie leur existence)\r\n- `check_data_rendering.py` (charge x.npy et x_len.npy)\r\n- `prepare_evaluation_data.py` (utilise collect_data())\r\n\r\n---\r\n\r\n#### `check_data.py`\r\n**RÃ´le :** VÃ©rification des fichiers de donnÃ©es prÃ©processÃ©es\r\n\r\n**Fonctions :**\r\n- VÃ©rifie l'existence de `data/processed/`\r\n- Liste les fichiers `.npy` prÃ©sents\r\n- VÃ©rifie les shapes et dtypes de chaque fichier\r\n\r\n**Interactions :**\r\n```\r\ncheck_data.py\r\n    â”‚\r\n    â””â”€â†’ Lit: data/processed/*.npy\r\n        â”œâ”€ x.npy\r\n        â”œâ”€ x_len.npy\r\n        â”œâ”€ c.npy\r\n        â””â”€ c_len.npy\r\n```\r\n\r\n**UtilisÃ© par :** Script de diagnostic manuel\r\n\r\n---\r\n\r\n#### `check_data_rendering.py`\r\n**RÃ´le :** Visualisation des strokes pour vÃ©rification\r\n\r\n**Fonctions :**\r\n- Charge `x.npy` et `x_len.npy`\r\n- Convertit les strokes en images\r\n- Sauvegarde des Ã©chantillons dans `debug_render/`\r\n\r\n**Interactions :**\r\n```\r\ncheck_data_rendering.py\r\n    â”‚\r\n    â”œâ”€â†’ import drawing\r\n    â”‚   â””â”€ Utilise drawing.draw() pour convertir strokes â†’ images\r\n    â”‚\r\n    â”œâ”€â†’ Lit: data/processed/x.npy\r\n    â”œâ”€â†’ Lit: data/processed/x_len.npy\r\n    â”‚\r\n    â””â”€â†’ Ã‰crit: debug_render/sample_X.png\r\n```\r\n\r\n**UtilisÃ© par :** VÃ©rification visuelle aprÃ¨s prÃ©paration\r\n\r\n---\r\n\r\n#### `diag_collect_stats.py`\r\n**RÃ´le :** Collecte de statistiques sur le dataset\r\n\r\n**Fonctions :**\r\n- Parcourt le dataset IAM\r\n- Compte les correspondances/non-correspondances\r\n- Identifie les problÃ¨mes de structure\r\n\r\n**Interactions :**\r\n```\r\ndiag_collect_stats.py\r\n    â”‚\r\n    â”œâ”€â†’ import prepare_data\r\n    â”‚   â””â”€ Utilise prepare_data.RAW_BASE_DIR, \r\n    â”‚      prepare_data.get_ascii_sequences()\r\n    â”‚\r\n    â””â”€â†’ Lit: data/raw/ascii/, data/raw/lineStrokes/\r\n```\r\n\r\n**UtilisÃ© par :** Diagnostic du dataset\r\n\r\n---\r\n\r\n#### `diag_prepare.py`\r\n**RÃ´le :** Diagnostic du processus de prÃ©paration\r\n\r\n**Interactions :**\r\n```\r\ndiag_prepare.py\r\n    â”‚\r\n    â””â”€â†’ Utilise prepare_data.py\r\n```\r\n\r\n---\r\n\r\n### **2. MODÃˆLES RNN/LSTM** â­ PRINCIPAL\r\n\r\n#### `rnn.py` â­ CORE\r\n**RÃ´le :** ModÃ¨le RNN principal avec LSTM et attention\r\n\r\n**Classes principales :**\r\n- `LSTMAttentionCell` : Cellule LSTM avec mÃ©canisme d'attention\r\n- `DataReader` : Lecteur de donnÃ©es pour l'entraÃ®nement\r\n- `RNN` : ModÃ¨le RNN complet\r\n\r\n**Interactions :**\r\n```\r\nrnn.py\r\n    â”‚\r\n    â”œâ”€â†’ import drawing\r\n    â”‚   â””â”€ Utilise drawing.alphabet, drawing.MAX_STROKE_LEN, \r\n    â”‚      drawing.MAX_CHAR_LEN\r\n    â”‚\r\n    â”œâ”€â†’ import data_frame (DataFrame)\r\n    â”‚   â””â”€ Utilise DataFrame pour gÃ©rer les batches\r\n    â”‚\r\n    â”œâ”€â†’ Lit: data/processed/*.npy\r\n    â”‚   â”œâ”€ x.npy\r\n    â”‚   â”œâ”€ x_len.npy\r\n    â”‚   â”œâ”€ c.npy\r\n    â”‚   â””â”€ c_len.npy\r\n    â”‚\r\n    â”œâ”€â†’ Utilise: rnn_cell.py (LSTMAttentionCell)\r\n    â”‚   â””â”€ Importe la cellule LSTM avec attention\r\n    â”‚\r\n    â””â”€â†’ Utilise: rnn_ops.py (optionnel)\r\n        â””â”€ OpÃ©rations RNN optimisÃ©es\r\n```\r\n\r\n**UtilisÃ© par :** Script d'entraÃ®nement principal\r\n\r\n**FonctionnalitÃ©s :**\r\n- `DataReader` : Charge et prÃ©pare les donnÃ©es\r\n- `RNN.forward()` : Forward pass avec GMM\r\n- `RNN.nll()` : Calcul de la loss (Negative Log Likelihood)\r\n- `RNN._rnn_free_run()` : GÃ©nÃ©ration sÃ©quentielle\r\n\r\n---\r\n\r\n#### `rnn_cell.py` â­ CORE\r\n**RÃ´le :** ImplÃ©mentation de la cellule LSTM avec attention\r\n\r\n**Classe principale :**\r\n- `LSTMAttentionCell` : Cellule LSTM avec mÃ©canisme d'attention\r\n\r\n**Interactions :**\r\n```\r\nrnn_cell.py\r\n    â”‚\r\n    â”œâ”€â†’ import drawing\r\n    â”‚   â””â”€ Utilise drawing.MAX_CHAR_LEN\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: rnn.py\r\n        â””â”€ ImportÃ© dans RNN.__init__()\r\n```\r\n\r\n**FonctionnalitÃ©s :**\r\n- `forward()` : Forward pass avec attention\r\n- `_compute_attention()` : Calcul des poids d'attention\r\n- `zero_state()` : Initialisation de l'Ã©tat\r\n\r\n**Architecture :**\r\n```\r\nInput: [dx, dy, eos] (3-D) + attention context\r\n    â†“\r\nAttention Projection (Linear 2â†’3)\r\n    â†“\r\nConcatÃ©nation [dx, dy, eos, attn_proj] (6-D)\r\n    â†“\r\nLSTMCell (6 â†’ lstm_size)\r\n    â†“\r\nAttention Computation (Mixture of Gaussians)\r\n    â†“\r\nOutput: hidden state (lstm_size)\r\n```\r\n\r\n---\r\n\r\n#### `rnn_ops.py`\r\n**RÃ´le :** OpÃ©rations RNN optimisÃ©es et utilitaires\r\n\r\n**Fonctions principales :**\r\n- `raw_rnn()` : Boucle RNN gÃ©nÃ©rique\r\n- `rnn_teacher_force()` : EntraÃ®nement avec ground truth\r\n- `rnn_free_run()` : GÃ©nÃ©ration autonome\r\n\r\n**Interactions :**\r\n```\r\nrnn_ops.py\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: rnn.py (optionnel)\r\n        â””â”€ Pour optimiser les opÃ©rations RNN\r\n```\r\n\r\n**UtilisÃ© par :** `rnn.py` si besoin d'optimisations\r\n\r\n---\r\n\r\n#### `tf_base_model.py`\r\n**RÃ´le :** ModÃ¨le de base TensorFlow (alternative)\r\n\r\n**Interactions :**\r\n```\r\ntf_base_model.py\r\n    â”‚\r\n    â”œâ”€â†’ Utilise: tf_utils.py\r\n    â”‚   â””â”€ Utilitaires TensorFlow\r\n    â”‚\r\n    â””â”€â†’ Alternative Ã  rnn.py (si TensorFlow prÃ©fÃ©rÃ©)\r\n```\r\n\r\n**UtilisÃ© par :** Si on veut utiliser TensorFlow au lieu de PyTorch\r\n\r\n---\r\n\r\n#### `tf_utils.py`\r\n**RÃ´le :** Utilitaires TensorFlow\r\n\r\n**Fonctions :**\r\n- `raw_rnn()` : Boucle RNN TensorFlow\r\n- `rnn_teacher_force()` : Teacher forcing TensorFlow\r\n- `rnn_free_run()` : Free run TensorFlow\r\n\r\n**Interactions :**\r\n```\r\ntf_utils.py\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: tf_base_model.py\r\n```\r\n\r\n---\r\n\r\n### **3. RENDU ET VISUALISATION**\r\n\r\n#### `drawing.py` â­ CORE\r\n**RÃ´le :** Utilitaires pour la conversion et manipulation des strokes\r\n\r\n**Fonctions principales :**\r\n- `align()` : Correction de l'inclinaison globale\r\n- `denoise()` : Lissage Savitzky-Golay\r\n- `normalize()` : Normalisation des offsets\r\n- `coords_to_offsets()` : Conversion coordonnÃ©es â†’ offsets\r\n- `offsets_to_coords()` : Conversion offsets â†’ coordonnÃ©es\r\n- `draw()` : Rendu strokes â†’ image matplotlib\r\n- `encode_ascii()` : Encodage texte â†’ indices\r\n\r\n**Constantes :**\r\n- `alphabet` : Liste des caractÃ¨res supportÃ©s\r\n- `MAX_STROKE_LEN` : 1200\r\n- `MAX_CHAR_LEN` : 75\r\n\r\n**Interactions :**\r\n```\r\ndrawing.py\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: prepare_data.py\r\n    â”‚   â”œâ”€ align(), denoise(), coords_to_offsets(), normalize()\r\n    â”‚   â””â”€ encode_ascii(), MAX_STROKE_LEN, MAX_CHAR_LEN, alphabet\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: rnn.py\r\n    â”‚   â””â”€ alphabet, MAX_STROKE_LEN, MAX_CHAR_LEN\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: rnn_cell.py\r\n    â”‚   â””â”€ MAX_CHAR_LEN\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: check_data_rendering.py\r\n    â”‚   â””â”€ draw() pour visualiser les strokes\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: prepare_evaluation_data.py\r\n        â””â”€ draw() pour gÃ©nÃ©rer images rÃ©elles\r\n```\r\n\r\n**C'est le fichier central** utilisÃ© par presque tous les autres modules !\r\n\r\n---\r\n\r\n#### `handwriting_renderer.py` â­ CORE\r\n**RÃ´le :** Rendu stylisÃ© d'Ã©criture manuscrite avec polices\r\n\r\n**Classes principales :**\r\n- `PaperStyle` : Styles de papier (plain, ruled, grid)\r\n- `RenderConfig` : Configuration de rendu\r\n- `HandwritingRenderer` : Moteur de rendu principal\r\n\r\n**Interactions :**\r\n```\r\nhandwriting_renderer.py\r\n    â”‚\r\n    â”œâ”€â†’ Utilise: PIL (Image, ImageDraw, ImageFont)\r\n    â”œâ”€â†’ Utilise: matplotlib.font_manager\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: streamlit_app.py\r\n    â”‚   â””â”€ HandwritingRenderer pour gÃ©nÃ©ration interactive\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: prepare_evaluation_data.py\r\n        â””â”€ GÃ©nÃ¨re images \"gÃ©nÃ©rÃ©es\" pour Ã©valuation\r\n```\r\n\r\n**FonctionnalitÃ©s :**\r\n- `render()` : GÃ©nÃ¨re une image depuis texte\r\n- `available_fonts()` : Liste les polices disponibles\r\n- `to_bytes()` : Conversion image â†’ bytes\r\n\r\n---\r\n\r\n### **4. GESTION DES DONNÃ‰ES**\r\n\r\n#### `data_frame.py`\r\n**RÃ´le :** Structure de donnÃ©es similaire Ã  pandas DataFrame\r\n\r\n**Classe principale :**\r\n- `DataFrame` : Gestion de matrices NumPy avec batching\r\n\r\n**Interactions :**\r\n```\r\ndata_frame.py\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: rnn.py\r\n        â””â”€ DataReader utilise DataFrame pour gÃ©rer les batches\r\n```\r\n\r\n**FonctionnalitÃ©s :**\r\n- `batch_generator()` : GÃ©nÃ©ration de batches\r\n- `train_test_split()` : Division train/test\r\n- `shuffle()` : MÃ©lange des donnÃ©es\r\n\r\n---\r\n\r\n#### `data/dataset.py`\r\n**RÃ´le :** Dataset personnalisÃ© (si utilisÃ©)\r\n\r\n**Interactions :**\r\n```\r\ndata/dataset.py\r\n    â”‚\r\n    â””â”€â†’ Peut Ãªtre utilisÃ© par les modÃ¨les\r\n```\r\n\r\n---\r\n\r\n### **5. Ã‰VALUATION ET MÃ‰TRIQUES**\r\n\r\n#### `metrics.py` â­ CORE\r\n**RÃ´le :** ImplÃ©mentation de toutes les mÃ©triques d'Ã©valuation\r\n\r\n**Classes et fonctions :**\r\n- `InceptionFeatureExtractor` : Extraction features pour FID/KID\r\n- `calculate_fid()` : FrÃ©chet Inception Distance\r\n- `calculate_kid()` : Kernel Inception Distance\r\n- `calculate_cer()` : Character Error Rate\r\n- `calculate_wer()` : Word Error Rate\r\n- `calculate_ssim()` : Structural Similarity Index\r\n- `calculate_psnr()` : Peak Signal-to-Noise Ratio\r\n- `calculate_lpips()` : Learned Perceptual Similarity\r\n- `ocr_image()` : OCR avec Tesseract\r\n- `calculate_ocr_accuracy()` : PrÃ©cision OCR\r\n- `evaluate_handwriting_metrics()` : Fonction principale\r\n\r\n**Interactions :**\r\n```\r\nmetrics.py\r\n    â”‚\r\n    â”œâ”€â†’ Utilise: PyTorch (torch, torchvision)\r\n    â”‚   â””â”€ Pour FID, KID, LPIPS\r\n    â”‚\r\n    â”œâ”€â†’ Utilise: scikit-image\r\n    â”‚   â””â”€ Pour SSIM\r\n    â”‚\r\n    â”œâ”€â†’ Utilise: pytesseract\r\n    â”‚   â””â”€ Pour OCR (CER, WER, OCR Accuracy)\r\n    â”‚\r\n    â”œâ”€â†’ Utilise: lpips\r\n    â”‚   â””â”€ Pour LPIPS\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: calculate_metrics.py\r\n    â”‚   â””â”€ evaluate_handwriting_metrics()\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: quick_metrics.py\r\n    â”‚   â””â”€ evaluate_handwriting_metrics()\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: evaluate_metrics.py\r\n    â”‚   â””â”€ evaluate_handwriting_metrics()\r\n    â”‚\r\n    â”œâ”€â†’ UtilisÃ© par: streamlit_metrics.py\r\n    â”‚   â””â”€ evaluate_handwriting_metrics()\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: prepare_evaluation_data.py\r\n        â””â”€ evaluate_handwriting_metrics()\r\n```\r\n\r\n**C'est le fichier central** pour toutes les mÃ©triques !\r\n\r\n---\r\n\r\n#### `calculate_metrics.py`\r\n**RÃ´le :** Script interactif guidÃ© pour calculer les mÃ©triques\r\n\r\n**Interactions :**\r\n```\r\ncalculate_metrics.py\r\n    â”‚\r\n    â”œâ”€â†’ import metrics\r\n    â”‚   â””â”€ Utilise metrics.evaluate_handwriting_metrics()\r\n    â”‚\r\n    â”œâ”€â†’ Lit: Images depuis dossiers spÃ©cifiÃ©s\r\n    â”‚\r\n    â””â”€â†’ Ã‰crit: RÃ©sultats Ã  l'Ã©cran\r\n```\r\n\r\n**UtilisÃ© par :** Utilisateur pour calcul interactif\r\n\r\n---\r\n\r\n#### `quick_metrics.py`\r\n**RÃ´le :** Script rapide avec chemins en dur ou variables d'environnement\r\n\r\n**Interactions :**\r\n```\r\nquick_metrics.py\r\n    â”‚\r\n    â”œâ”€â†’ import metrics\r\n    â”‚   â””â”€ Utilise metrics.evaluate_handwriting_metrics()\r\n    â”‚\r\n    â””â”€â†’ Lit: Images depuis chemins configurÃ©s\r\n```\r\n\r\n**UtilisÃ© par :** Automatisation et scripts batch\r\n\r\n---\r\n\r\n#### `evaluate_metrics.py`\r\n**RÃ´le :** Script avancÃ© avec options ligne de commande\r\n\r\n**Interactions :**\r\n```\r\nevaluate_metrics.py\r\n    â”‚\r\n    â”œâ”€â†’ import metrics\r\n    â”‚   â””â”€ Utilise metrics.evaluate_handwriting_metrics()\r\n    â”‚\r\n    â”œâ”€â†’ Arguments CLI:\r\n    â”‚   â”œâ”€ --real_dir\r\n    â”‚   â”œâ”€ --gen_dir\r\n    â”‚   â”œâ”€ --ground_truth_texts\r\n    â”‚   â”œâ”€ --use_ocr\r\n    â”‚   â””â”€ --output\r\n    â”‚\r\n    â””â”€â†’ Ã‰crit: JSON avec rÃ©sultats\r\n```\r\n\r\n**UtilisÃ© par :** Scripts automatisÃ©s et pipelines\r\n\r\n---\r\n\r\n#### `streamlit_metrics.py`\r\n**RÃ´le :** Interface Streamlit pour les mÃ©triques\r\n\r\n**Interactions :**\r\n```\r\nstreamlit_metrics.py\r\n    â”‚\r\n    â”œâ”€â†’ import metrics\r\n    â”‚   â””â”€ Utilise metrics.evaluate_handwriting_metrics()\r\n    â”‚\r\n    â”œâ”€â†’ Interface graphique:\r\n    â”‚   â”œâ”€ SÃ©lection dossiers\r\n    â”‚   â”œâ”€ AperÃ§u images\r\n    â”‚   â”œâ”€ Calcul mÃ©triques\r\n    â”‚   â””â”€ Export JSON\r\n    â”‚\r\n    â””â”€â†’ UtilisÃ© par: streamlit run streamlit_metrics.py\r\n```\r\n\r\n**UtilisÃ© par :** Interface utilisateur graphique\r\n\r\n---\r\n\r\n#### `prepare_evaluation_data.py`\r\n**RÃ´le :** PrÃ©paration des donnÃ©es pour l'Ã©valuation\r\n\r\n**Interactions :**\r\n```\r\nprepare_evaluation_data.py\r\n    â”‚\r\n    â”œâ”€â†’ import prepare_data\r\n    â”‚   â””â”€ Utilise prepare_data.check_dataset_exists(),\r\n    â”‚      prepare_data.collect_data(),\r\n    â”‚      prepare_data.get_stroke_sequence()\r\n    â”‚\r\n    â”œâ”€â†’ import drawing\r\n    â”‚   â””â”€ Utilise drawing.draw(), drawing.alphabet\r\n    â”‚\r\n    â”œâ”€â†’ import handwriting_renderer\r\n    â”‚   â””â”€ Utilise HandwritingRenderer pour gÃ©nÃ©rer images\r\n    â”‚\r\n    â”œâ”€â†’ import metrics\r\n    â”‚   â””â”€ Utilise metrics.evaluate_handwriting_metrics()\r\n    â”‚\r\n    â”œâ”€â†’ Lit: Dataset IAM\r\n    â”‚\r\n    â”œâ”€â†’ Ã‰crit: evaluation/real/*.png (images rÃ©elles)\r\n    â”œâ”€â†’ Ã‰crit: evaluation/gen/*.png (images gÃ©nÃ©rÃ©es)\r\n    â”‚\r\n    â””â”€â†’ Ã‰crit: metrics_results_full.json\r\n```\r\n\r\n**UtilisÃ© par :** PrÃ©paration avant Ã©valuation complÃ¨te\r\n\r\n---\r\n\r\n### **6. INTERFACES UTILISATEUR**\r\n\r\n#### `streamlit_app.py` â­ CORE\r\n**RÃ´le :** Interface principale Streamlit pour gÃ©nÃ©ration\r\n\r\n**Interactions :**\r\n```\r\nstreamlit_app.py\r\n    â”‚\r\n    â”œâ”€â†’ import handwriting_renderer\r\n    â”‚   â””â”€ Utilise HandwritingRenderer, PAPER_PRESETS, RenderConfig\r\n    â”‚\r\n    â””â”€â†’ Interface:\r\n        â”œâ”€ Saisie texte\r\n        â”œâ”€ Choix police\r\n        â”œâ”€ ParamÃ¨tres style\r\n        â””â”€ GÃ©nÃ©ration + tÃ©lÃ©chargement\r\n```\r\n\r\n**UtilisÃ© par :** `streamlit run streamlit_app.py`\r\n\r\n---\r\n\r\n#### `streamlit_metrics.py`\r\n**RÃ´le :** Interface Streamlit pour mÃ©triques\r\n\r\n**Interactions :**\r\n```\r\nstreamlit_metrics.py\r\n    â”‚\r\n    â”œâ”€â†’ import metrics\r\n    â”‚   â””â”€ Utilise metrics.evaluate_handwriting_metrics()\r\n    â”‚\r\n    â””â”€â†’ Interface graphique pour mÃ©triques\r\n```\r\n\r\n**UtilisÃ© par :** `streamlit run streamlit_metrics.py`\r\n\r\n---\r\n\r\n### **7. DOCUMENTATION**\r\n\r\n#### `ARCHITECTURE_GUIDE.md`\r\n**RÃ´le :** Guide complet de l'architecture\r\n\r\n**Contenu :**\r\n- Vue d'ensemble du projet\r\n- Pipeline dÃ©taillÃ©\r\n- Architecture des modÃ¨les\r\n- Workflow\r\n\r\n---\r\n\r\n#### `PIPELINE_DIAGRAM.md`\r\n**RÃ´le :** Diagrammes visuels du pipeline\r\n\r\n**Contenu :**\r\n- Diagrammes ASCII\r\n- Flux de donnÃ©es\r\n- Comparaisons d'approches\r\n\r\n---\r\n\r\n#### `METRICS_GUIDE.md`\r\n**RÃ´le :** Guide d'utilisation des mÃ©triques\r\n\r\n**Contenu :**\r\n- Explication des mÃ©triques\r\n- Guide d'utilisation des scripts\r\n- InterprÃ©tation des rÃ©sultats\r\n\r\n---\r\n\r\n#### `FICHIERS_ET_INTERACTIONS.md` (ce fichier)\r\n**RÃ´le :** Guide complet des fichiers et interactions\r\n\r\n---\r\n\r\n### **8. CONFIGURATION**\r\n\r\n#### `requirements.txt`\r\n**RÃ´le :** DÃ©pendances Python du projet\r\n\r\n**Contenu :**\r\n- matplotlib, pandas, scikit-learn, scipy\r\n- svgwrite, tensorflow, Pillow\r\n- streamlit, torch, torchvision\r\n- scikit-image, pytesseract, lpips\r\n\r\n---\r\n\r\n## ğŸ”„ Graphique des Interactions Principales\r\n\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚              GRAPHE DES DÃ‰PENDANCES PRINCIPALES                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n                    drawing.py â­ CENTRAL\r\n                         â”‚\r\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n        â”‚                â”‚                â”‚\r\n        â–¼                â–¼                â–¼\r\n  prepare_data.py    rnn.py          check_data_rendering.py\r\n        â”‚                â”‚                â”‚\r\n        â”‚                â”‚                â”‚\r\n        â–¼                â–¼                â”‚\r\n  data/processed/     rnn_cell.py         â”‚\r\n        â”‚                â”‚                â”‚\r\n        â”‚                â”‚                â”‚\r\n        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                         â”‚\r\n                         â–¼\r\n                    data_frame.py\r\n                         â”‚\r\n                         â–¼\r\n                    [EntraÃ®nement RNN]\r\n                         â”‚\r\n                         â–¼\r\n                    [GÃ©nÃ©ration Strokes]\r\n                         â”‚\r\n                         â–¼\r\n                    drawing.draw()\r\n                         â”‚\r\n                         â–¼\r\n                    [Image 128Ã—128]\r\n\r\n\r\nhandwriting_renderer.py\r\n        â”‚\r\n        â–¼\r\nstreamlit_app.py â”€â”€â†’ [Interface Utilisateur]\r\n\r\n\r\nprepare_evaluation_data.py\r\n        â”‚\r\n        â”œâ”€â†’ prepare_data.py\r\n        â”œâ”€â†’ drawing.py\r\n        â”œâ”€â†’ handwriting_renderer.py\r\n        â””â”€â†’ metrics.py\r\n            â”‚\r\n            â–¼\r\n    evaluation/real/ + evaluation/gen/\r\n            â”‚\r\n            â–¼\r\n    metrics.py â”€â”€â†’ [Toutes les mÃ©triques]\r\n            â”‚\r\n            â”œâ”€â†’ calculate_metrics.py\r\n            â”œâ”€â†’ quick_metrics.py\r\n            â”œâ”€â†’ evaluate_metrics.py\r\n            â””â”€â†’ streamlit_metrics.py\r\n```\r\n\r\n---\r\n\r\n## ğŸ“Š Matrice des DÃ©pendances\r\n\r\n| Fichier | Utilise | UtilisÃ© par |\r\n|---------|---------|-------------|\r\n| `drawing.py` | - | `prepare_data.py`, `rnn.py`, `rnn_cell.py`, `check_data_rendering.py`, `prepare_evaluation_data.py` |\r\n| `prepare_data.py` | `drawing.py` | `rnn.py`, `check_data.py`, `prepare_evaluation_data.py`, `diag_collect_stats.py` |\r\n| `rnn.py` | `drawing.py`, `data_frame.py`, `rnn_cell.py` | Script d'entraÃ®nement |\r\n| `rnn_cell.py` | `drawing.py` | `rnn.py` |\r\n| `data_frame.py` | - | `rnn.py` |\r\n| `handwriting_renderer.py` | PIL, matplotlib | `streamlit_app.py`, `prepare_evaluation_data.py` |\r\n| `metrics.py` | PyTorch, scikit-image, pytesseract, lpips | `calculate_metrics.py`, `quick_metrics.py`, `evaluate_metrics.py`, `streamlit_metrics.py`, `prepare_evaluation_data.py` |\r\n| `check_data_rendering.py` | `drawing.py` | Diagnostic |\r\n| `prepare_evaluation_data.py` | `prepare_data.py`, `drawing.py`, `handwriting_renderer.py`, `metrics.py` | Ã‰valuation |\r\n| `streamlit_app.py` | `handwriting_renderer.py` | Interface utilisateur |\r\n| `streamlit_metrics.py` | `metrics.py` | Interface utilisateur |\r\n\r\n---\r\n\r\n## ğŸ”— Flux de DonnÃ©es Complet\r\n\r\n### **Flux 1 : PrÃ©paration des DonnÃ©es**\r\n```\r\nDataset IAM (XML, ASCII)\r\n    â†“\r\nprepare_data.py\r\n    â”œâ”€â†’ Utilise drawing.py (align, denoise, normalize, etc.)\r\n    â†“\r\ndata/processed/*.npy\r\n    â”œâ”€â†’ x.npy (strokes)\r\n    â”œâ”€â†’ x_len.npy (longueurs)\r\n    â”œâ”€â†’ c.npy (transcriptions)\r\n    â”œâ”€â†’ c_len.npy (longueurs textes)\r\n    â””â”€â†’ w_id.npy (IDs Ã©crivains)\r\n```\r\n\r\n### **Flux 2 : EntraÃ®nement RNN**\r\n```\r\ndata/processed/*.npy\r\n    â†“\r\nrnn.py (DataReader)\r\n    â”œâ”€â†’ Utilise data_frame.py (DataFrame)\r\n    â”œâ”€â†’ Utilise rnn_cell.py (LSTMAttentionCell)\r\n    â”œâ”€â†’ Utilise drawing.py (alphabet, constants)\r\n    â†“\r\nRNN Model\r\n    â”œâ”€â†’ Forward pass\r\n    â”œâ”€â†’ Loss calculation\r\n    â””â”€â†’ Backpropagation\r\n```\r\n\r\n### **Flux 3 : GÃ©nÃ©ration**\r\n```\r\nTexte utilisateur\r\n    â†“\r\nOption A: handwriting_renderer.py\r\n    â””â”€â†’ streamlit_app.py\r\n        â””â”€â†’ Image stylisÃ©e\r\n\r\nOption B: RNN entraÃ®nÃ©\r\n    â””â”€â†’ rnn.py (gÃ©nÃ©ration)\r\n        â””â”€â†’ drawing.draw()\r\n            â””â”€â†’ Image depuis strokes\r\n```\r\n\r\n### **Flux 4 : Ã‰valuation**\r\n```\r\nprepare_evaluation_data.py\r\n    â”œâ”€â†’ prepare_data.py (collect_data)\r\n    â”œâ”€â†’ drawing.py (draw strokes â†’ images rÃ©elles)\r\n    â”œâ”€â†’ handwriting_renderer.py (gÃ©nÃ¨re images stylisÃ©es)\r\n    â†“\r\nevaluation/real/ + evaluation/gen/\r\n    â†“\r\nmetrics.py (evaluate_handwriting_metrics)\r\n    â”œâ”€â†’ calculate_metrics.py\r\n    â”œâ”€â†’ quick_metrics.py\r\n    â”œâ”€â†’ evaluate_metrics.py\r\n    â””â”€â†’ streamlit_metrics.py\r\n    â†“\r\nRÃ©sultats JSON\r\n```\r\n\r\n---\r\n\r\n## ğŸ¯ Points d'EntrÃ©e Principaux\r\n\r\n### **1. PrÃ©paration des DonnÃ©es**\r\n```bash\r\npython prepare_data.py\r\n```\r\n- **Fichiers impliquÃ©s :** `prepare_data.py`, `drawing.py`\r\n- **Sortie :** `data/processed/*.npy`\r\n\r\n### **2. VÃ©rification**\r\n```bash\r\npython check_data.py\r\npython check_data_rendering.py\r\n```\r\n- **Fichiers impliquÃ©s :** `check_data.py`, `check_data_rendering.py`, `drawing.py`\r\n- **Sortie :** VÃ©rifications + `debug_render/*.png`\r\n\r\n### **3. EntraÃ®nement**\r\n```bash\r\npython rnn.py\r\n```\r\n- **Fichiers impliquÃ©s :** `rnn.py`, `rnn_cell.py`, `rnn_ops.py`, `data_frame.py`, `drawing.py`\r\n- **Sortie :** ModÃ¨le entraÃ®nÃ©\r\n\r\n### **4. GÃ©nÃ©ration (Interface)**\r\n```bash\r\nstreamlit run streamlit_app.py\r\n```\r\n- **Fichiers impliquÃ©s :** `streamlit_app.py`, `handwriting_renderer.py`\r\n- **Sortie :** Images gÃ©nÃ©rÃ©es interactivement\r\n\r\n### **5. Ã‰valuation**\r\n```bash\r\npython prepare_evaluation_data.py\r\npython calculate_metrics.py\r\n# ou\r\nstreamlit run streamlit_metrics.py\r\n```\r\n- **Fichiers impliquÃ©s :** `prepare_evaluation_data.py`, `metrics.py`, `drawing.py`, `handwriting_renderer.py`\r\n- **Sortie :** MÃ©triques calculÃ©es\r\n\r\n---\r\n\r\n## ğŸ” Fichiers ClÃ©s par RÃ´le\r\n\r\n### **Fichiers Centraux (utilisÃ©s par beaucoup)**\r\n1. **`drawing.py`** â­ - UtilisÃ© par 5+ fichiers\r\n2. **`metrics.py`** â­ - UtilisÃ© par 4+ fichiers\r\n3. **`prepare_data.py`** â­ - Point d'entrÃ©e principal\r\n\r\n### **Fichiers ModÃ¨les**\r\n1. **`rnn.py`** â­ - ModÃ¨le principal\r\n2. **`rnn_cell.py`** â­ - Cellule LSTM\r\n3. **`rnn_ops.py`** - Utilitaires RNN\r\n\r\n### **Fichiers Interface**\r\n1. **`streamlit_app.py`** â­ - Interface principale\r\n2. **`streamlit_metrics.py`** - Interface mÃ©triques\r\n\r\n### **Fichiers Utilitaires**\r\n1. **`data_frame.py`** - Gestion donnÃ©es\r\n2. **`handwriting_renderer.py`** â­ - Rendu stylisÃ©\r\n3. **`tf_utils.py`** - Utilitaires TensorFlow\r\n\r\n### **Fichiers Diagnostic**\r\n1. **`check_data.py`** - VÃ©rification donnÃ©es\r\n2. **`check_data_rendering.py`** - VÃ©rification rendu\r\n3. **`diag_collect_stats.py`** - Statistiques\r\n4. **`diag_prepare.py`** - Diagnostic prÃ©paration\r\n\r\n---\r\n\r\n## ğŸ“ RÃ©sumÃ© des Interactions\r\n\r\n### **HiÃ©rarchie des DÃ©pendances**\r\n\r\n**Niveau 0 (Fondations) :**\r\n- `drawing.py` - Utilitaires de base\r\n- `data_frame.py` - Structure de donnÃ©es\r\n\r\n**Niveau 1 (PrÃ©paration) :**\r\n- `prepare_data.py` â†’ utilise `drawing.py`\r\n- `check_data.py` â†’ lit `data/processed/`\r\n- `check_data_rendering.py` â†’ utilise `drawing.py`\r\n\r\n**Niveau 2 (ModÃ¨les) :**\r\n- `rnn_cell.py` â†’ utilise `drawing.py`\r\n- `rnn.py` â†’ utilise `drawing.py`, `data_frame.py`, `rnn_cell.py`\r\n\r\n**Niveau 3 (Rendu) :**\r\n- `handwriting_renderer.py` - IndÃ©pendant\r\n- `streamlit_app.py` â†’ utilise `handwriting_renderer.py`\r\n\r\n**Niveau 4 (Ã‰valuation) :**\r\n- `metrics.py` - IndÃ©pendant (utilise libs externes)\r\n- `prepare_evaluation_data.py` â†’ utilise `prepare_data.py`, `drawing.py`, `handwriting_renderer.py`, `metrics.py`\r\n- Scripts mÃ©triques â†’ utilisent `metrics.py`\r\n\r\n---\r\n\r\n---\r\n\r\n## ğŸ¨ Diagramme Visuel des Interactions\r\n\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚              DIAGRAMME COMPLET DES INTERACTIONS                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n                    â”‚ drawing.py â”‚ â­ CENTRAL\r\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                           â”‚\r\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n        â”‚                  â”‚                  â”‚\r\n        â–¼                  â–¼                  â–¼\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚prepare_data  â”‚   â”‚   rnn.py     â”‚   â”‚check_data_   â”‚\r\nâ”‚    .py       â”‚   â”‚              â”‚   â”‚rendering.py  â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n        â”‚                  â”‚                  â”‚\r\n        â”‚                  â”‚                  â”‚\r\n        â–¼                  â–¼                  â–¼\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚data/processedâ”‚   â”‚rnn_cell.py   â”‚   â”‚debug_render/ â”‚\r\nâ”‚   /*.npy     â”‚   â”‚              â”‚   â”‚  *.png       â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n        â”‚                  â”‚\r\n        â”‚                  â”‚\r\n        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                   â”‚\r\n                   â–¼\r\n            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n            â”‚data_frame.py â”‚\r\n            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                   â”‚\r\n                   â–¼\r\n            [ENTRAÃNEMENT]\r\n                   â”‚\r\n                   â–¼\r\n            [GÃ‰NÃ‰RATION]\r\n                   â”‚\r\n                   â–¼\r\n            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n            â”‚drawing.draw()â”‚\r\n            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                   â”‚\r\n                   â–¼\r\n            [IMAGE 128Ã—128]\r\n\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚                    BRANCHE RENDU STYLISÃ‰                    â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n            â”‚handwriting_  â”‚\r\n            â”‚renderer.py   â”‚\r\n            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                   â”‚\r\n                   â–¼\r\n            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n            â”‚streamlit_    â”‚\r\n            â”‚app.py        â”‚\r\n            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                   â”‚\r\n                   â–¼\r\n            [INTERFACE WEB]\r\n\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚                    BRANCHE Ã‰VALUATION                       â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚prepare_      â”‚\r\nâ”‚evaluation_   â”‚\r\nâ”‚data.py       â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n        â”‚\r\n        â”œâ”€â†’ prepare_data.py\r\n        â”œâ”€â†’ drawing.py\r\n        â”œâ”€â†’ handwriting_renderer.py\r\n        â”‚\r\n        â–¼\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚evaluation/   â”‚\r\nâ”‚real/ + gen/  â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n        â”‚\r\n        â–¼\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚  metrics.py  â”‚ â­ CENTRAL\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n        â”‚\r\n        â”œâ”€â†’ calculate_metrics.py\r\n        â”œâ”€â†’ quick_metrics.py\r\n        â”œâ”€â†’ evaluate_metrics.py\r\n        â””â”€â†’ streamlit_metrics.py\r\n        â”‚\r\n        â–¼\r\n    [RÃ‰SULTATS JSON]\r\n```\r\n\r\n---\r\n\r\n## ğŸ”„ Cycles de Vie des DonnÃ©es\r\n\r\n### **Cycle 1 : PrÃ©paration â†’ EntraÃ®nement â†’ GÃ©nÃ©ration**\r\n```\r\n1. Dataset IAM brut\r\n   â†“\r\n2. prepare_data.py + drawing.py\r\n   â†“\r\n3. data/processed/*.npy\r\n   â†“\r\n4. rnn.py + rnn_cell.py + data_frame.py\r\n   â†“\r\n5. ModÃ¨le entraÃ®nÃ©\r\n   â†“\r\n6. GÃ©nÃ©ration strokes\r\n   â†“\r\n7. drawing.draw()\r\n   â†“\r\n8. Image finale\r\n```\r\n\r\n### **Cycle 2 : Ã‰valuation ComplÃ¨te**\r\n```\r\n1. prepare_evaluation_data.py\r\n   â”œâ”€â†’ prepare_data.py (collect_data)\r\n   â”œâ”€â†’ drawing.py (images rÃ©elles)\r\n   â””â”€â†’ handwriting_renderer.py (images gÃ©nÃ©rÃ©es)\r\n   â†“\r\n2. evaluation/real/ + evaluation/gen/\r\n   â†“\r\n3. metrics.py (calcul mÃ©triques)\r\n   â†“\r\n4. Scripts mÃ©triques (interface)\r\n   â†“\r\n5. RÃ©sultats JSON\r\n```\r\n\r\n---\r\n\r\n## ğŸ“‹ Checklist des Fichiers par CatÃ©gorie\r\n\r\n### âœ… **Fichiers Core (Essentiels)**\r\n- [x] `drawing.py` - Utilitaires strokes\r\n- [x] `prepare_data.py` - PrÃ©paration donnÃ©es\r\n- [x] `rnn.py` - ModÃ¨le principal\r\n- [x] `rnn_cell.py` - Cellule LSTM\r\n- [x] `handwriting_renderer.py` - Rendu stylisÃ©\r\n- [x] `metrics.py` - MÃ©triques\r\n- [x] `streamlit_app.py` - Interface principale\r\n\r\n### âœ… **Fichiers Utilitaires**\r\n- [x] `data_frame.py` - Gestion donnÃ©es\r\n- [x] `rnn_ops.py` - OpÃ©rations RNN\r\n- [x] `tf_utils.py` - Utilitaires TensorFlow\r\n- [x] `tf_base_model.py` - ModÃ¨le TensorFlow\r\n\r\n### âœ… **Fichiers Diagnostic**\r\n- [x] `check_data.py` - VÃ©rification donnÃ©es\r\n- [x] `check_data_rendering.py` - VÃ©rification rendu\r\n- [x] `diag_collect_stats.py` - Statistiques\r\n- [x] `diag_prepare.py` - Diagnostic\r\n\r\n### âœ… **Fichiers Ã‰valuation**\r\n- [x] `prepare_evaluation_data.py` - PrÃ©paration Ã©valuation\r\n- [x] `calculate_metrics.py` - Script interactif\r\n- [x] `quick_metrics.py` - Script rapide\r\n- [x] `evaluate_metrics.py` - Script avancÃ©\r\n- [x] `streamlit_metrics.py` - Interface mÃ©triques\r\n\r\n### âœ… **Fichiers Documentation**\r\n- [x] `ARCHITECTURE_GUIDE.md` - Guide architecture\r\n- [x] `PIPELINE_DIAGRAM.md` - Diagrammes pipeline\r\n- [x] `METRICS_GUIDE.md` - Guide mÃ©triques\r\n- [x] `FICHIERS_ET_INTERACTIONS.md` - Ce document\r\n\r\n---\r\n\r\n---\r\n\r\n## ğŸ¯ Intersections Critiques\r\n\r\n### **Intersection 1 : drawing.py (Hub Central)**\r\n\r\n`drawing.py` est le **fichier le plus utilisÃ©** dans le projet :\r\n\r\n```\r\n                    drawing.py\r\n                         â”‚\r\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n        â”‚                â”‚                â”‚\r\n        â–¼                â–¼                â–¼\r\nprepare_data.py      rnn.py      check_data_rendering.py\r\n        â”‚                â”‚                â”‚\r\n        â”‚                â”‚                â”‚\r\n        â–¼                â–¼                â–¼\r\n    [Data]          [Model]          [Debug]\r\n```\r\n\r\n**Pourquoi central ?**\r\n- DÃ©finit `alphabet` (utilisÃ© partout)\r\n- DÃ©finit `MAX_STROKE_LEN`, `MAX_CHAR_LEN` (constantes globales)\r\n- Fournit toutes les fonctions de transformation strokes\r\n- Point unique de conversion strokes â†” images\r\n\r\n---\r\n\r\n### **Intersection 2 : data/processed/ (Hub de DonnÃ©es)**\r\n\r\nTous les fichiers de donnÃ©es convergent vers `data/processed/` :\r\n\r\n```\r\nprepare_data.py â”€â”€â†’ data/processed/*.npy\r\n                            â”‚\r\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n        â”‚                    â”‚                    â”‚\r\n        â–¼                    â–¼                    â–¼\r\n    rnn.py            check_data.py      check_data_rendering.py\r\n    (entraÃ®nement)    (vÃ©rification)    (visualisation)\r\n```\r\n\r\n**Fichiers crÃ©Ã©s :**\r\n- `x.npy` : Strokes normalisÃ©s\r\n- `x_len.npy` : Longueurs rÃ©elles\r\n- `c.npy` : Transcriptions encodÃ©es\r\n- `c_len.npy` : Longueurs textes\r\n- `w_id.npy` : IDs Ã©crivains\r\n\r\n---\r\n\r\n### **Intersection 3 : metrics.py (Hub d'Ã‰valuation)**\r\n\r\nTous les scripts d'Ã©valuation utilisent `metrics.py` :\r\n\r\n```\r\n                    metrics.py\r\n                         â”‚\r\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\n        â”‚                â”‚                â”‚\r\n        â–¼                â–¼                â–¼\r\ncalculate_metrics.py  quick_metrics.py  evaluate_metrics.py\r\n        â”‚                â”‚                â”‚\r\n        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n                         â”‚\r\n                         â–¼\r\n                streamlit_metrics.py\r\n```\r\n\r\n**Fonction centrale :**\r\n- `evaluate_handwriting_metrics()` : Calcule toutes les mÃ©triques\r\n\r\n---\r\n\r\n### **Intersection 4 : RNN Pipeline**\r\n\r\nLe pipeline RNN connecte plusieurs fichiers :\r\n\r\n```\r\ndata/processed/*.npy\r\n        â”‚\r\n        â–¼\r\n    rnn.py (DataReader)\r\n        â”‚\r\n        â”œâ”€â†’ data_frame.py (DataFrame)\r\n        â”œâ”€â†’ rnn_cell.py (LSTMAttentionCell)\r\n        â””â”€â†’ drawing.py (alphabet, constants)\r\n        â”‚\r\n        â–¼\r\n    [EntraÃ®nement]\r\n        â”‚\r\n        â–¼\r\n    [GÃ©nÃ©ration Strokes]\r\n        â”‚\r\n        â–¼\r\n    drawing.draw()\r\n        â”‚\r\n        â–¼\r\n    [Image 128Ã—128]\r\n```\r\n\r\n---\r\n\r\n## ğŸ”— ChaÃ®nes de DÃ©pendances\r\n\r\n### **ChaÃ®ne 1 : PrÃ©paration â†’ EntraÃ®nement**\r\n```\r\nprepare_data.py\r\n    â†’ utilise drawing.py\r\n    â†’ crÃ©e data/processed/*.npy\r\n        â†“\r\nrnn.py (DataReader)\r\n    â†’ lit data/processed/*.npy\r\n    â†’ utilise data_frame.py\r\n    â†’ utilise rnn_cell.py\r\n    â†’ utilise drawing.py\r\n```\r\n\r\n### **ChaÃ®ne 2 : GÃ©nÃ©ration Utilisateur**\r\n```\r\nstreamlit_app.py\r\n    â†’ utilise handwriting_renderer.py\r\n    â†’ gÃ©nÃ¨re image directement\r\n```\r\n\r\n### **ChaÃ®ne 3 : Ã‰valuation ComplÃ¨te**\r\n```\r\nprepare_evaluation_data.py\r\n    â†’ utilise prepare_data.py\r\n    â†’ utilise drawing.py\r\n    â†’ utilise handwriting_renderer.py\r\n    â†’ crÃ©e evaluation/real/ + evaluation/gen/\r\n        â†“\r\nmetrics.py\r\n    â†’ lit evaluation/real/ + evaluation/gen/\r\n    â†’ calcule mÃ©triques\r\n        â†“\r\nScripts mÃ©triques\r\n    â†’ utilisent metrics.py\r\n    â†’ affichent rÃ©sultats\r\n```\r\n\r\n---\r\n\r\n## ğŸ“Š Tableau RÃ©capitulatif des Fichiers\r\n\r\n| Fichier | CatÃ©gorie | RÃ´le | DÃ©pendances | UtilisÃ© par |\r\n|---------|-----------|------|-------------|-------------|\r\n| `drawing.py` | Core | Utilitaires strokes | - | 5+ fichiers |\r\n| `prepare_data.py` | PrÃ©paration | PrÃ©paration dataset | `drawing.py` | 4+ fichiers |\r\n| `rnn.py` | ModÃ¨le | ModÃ¨le RNN principal | `drawing.py`, `data_frame.py`, `rnn_cell.py` | EntraÃ®nement |\r\n| `rnn_cell.py` | ModÃ¨le | Cellule LSTM | `drawing.py` | `rnn.py` |\r\n| `rnn_ops.py` | ModÃ¨le | OpÃ©rations RNN | - | `rnn.py` (optionnel) |\r\n| `data_frame.py` | Utilitaires | Gestion donnÃ©es | - | `rnn.py` |\r\n| `handwriting_renderer.py` | Rendu | Rendu stylisÃ© | PIL, matplotlib | `streamlit_app.py`, `prepare_evaluation_data.py` |\r\n| `metrics.py` | Ã‰valuation | MÃ©triques | PyTorch, scikit-image, pytesseract | 4+ scripts |\r\n| `streamlit_app.py` | Interface | Interface principale | `handwriting_renderer.py` | Utilisateur |\r\n| `streamlit_metrics.py` | Interface | Interface mÃ©triques | `metrics.py` | Utilisateur |\r\n| `check_data.py` | Diagnostic | VÃ©rification | - | Diagnostic |\r\n| `check_data_rendering.py` | Diagnostic | Visualisation | `drawing.py` | Diagnostic |\r\n| `prepare_evaluation_data.py` | Ã‰valuation | PrÃ©paration Ã©val | `prepare_data.py`, `drawing.py`, `handwriting_renderer.py`, `metrics.py` | Ã‰valuation |\r\n| `calculate_metrics.py` | Ã‰valuation | Script interactif | `metrics.py` | Utilisateur |\r\n| `quick_metrics.py` | Ã‰valuation | Script rapide | `metrics.py` | Automatisation |\r\n| `evaluate_metrics.py` | Ã‰valuation | Script avancÃ© | `metrics.py` | Scripts |\r\n| `diag_collect_stats.py` | Diagnostic | Statistiques | `prepare_data.py` | Diagnostic |\r\n| `diag_prepare.py` | Diagnostic | Diagnostic | `prepare_data.py` | Diagnostic |\r\n| `tf_base_model.py` | ModÃ¨le | ModÃ¨le TensorFlow | `tf_utils.py` | Alternative |\r\n| `tf_utils.py` | Utilitaires | Utils TensorFlow | - | `tf_base_model.py` |\r\n\r\n---\r\n\r\n## ğŸ“ Points ClÃ©s Ã  Retenir\r\n\r\n1. **`drawing.py` est le hub central** - UtilisÃ© par presque tous les modules\r\n2. **`data/processed/` est le hub de donnÃ©es** - Tous les fichiers de donnÃ©es y convergent\r\n3. **`metrics.py` est le hub d'Ã©valuation** - Tous les scripts mÃ©triques l'utilisent\r\n4. **Le pipeline RNN** connecte : `prepare_data.py` â†’ `rnn.py` â†’ `rnn_cell.py` â†’ `drawing.py`\r\n5. **Deux approches de gÃ©nÃ©ration** :\r\n   - RNN/LSTM : `rnn.py` â†’ `drawing.draw()` â†’ Image\r\n   - Rendu stylisÃ© : `handwriting_renderer.py` â†’ Image directe\r\n\r\n---\r\n\r\nCe document fournit une vue complÃ¨te de tous les fichiers et de leurs interactions dans l'architecture du projet !\r\n\r\n",
  "toolName": "auto-backup",
  "toolInput": {
    "file_path": "aarchitecture.md",
    "trigger": "local-change"
  },
  "metadata": {
    "lineCount": 1258,
    "characterCount": 33960,
    "fileSize": 38632,
    "language": "markdown",
    "mimeType": "text/plain",
    "contentHash": "dab68007cff1c4dd2dd7df404eb3e6656a2a1a35e165ebaf69712a6d4dc87996"
  },
  "backupType": "auto-local-change",
  "checkpointLabel": "File modified: aarchitecture.md"
}